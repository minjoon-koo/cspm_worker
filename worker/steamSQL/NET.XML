<?xml version="1.0" encoding="UTF-8"?>
<Queries>
    <Query name="getAppGateway">
        select
        display_name, mail, department, member_of
        from
        azuread_user
    </Query>
    <Query name="getBackendName">
        select
            name as apgw_name,
            probe -> 'name' as backend_name,
            jsonb_array_elements(probe -> 'properties' -> 'backendAddresses') ->> 'ipAddress' AS ipAddress,
            probe -> 'id' as backend_id
        from
            azure_application_gateway,
            jsonb_array_elements(backend_address_pools) as probe
    </Query>
    <Query name="azCliAppGatewayHealthCheck">
        az network application-gateway show-backend-health --resource-group rg-soldout --name 
    </Query>

</Queries>


